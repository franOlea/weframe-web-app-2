<template>
  <require from="./blob-to-url"></require>
  <require from="./file-list-to-array"></require>
  <div class="form-group" style="height: 20%;">
    <h1>Subir imagen</h1>
    <div class="custom-file">
      <input type="file" class="custom-file-input" name="file" id="imageFile" required accept=".jpg" files.bind="selectedFiles" lang="es">
      <label class="custom-file-label" for="imageFile">Click aqui para deleccionar Archivo</label>
    </div>
  </div>
  <div style="height: 80%; overflow-y: scroll;">
    <div class="row" repeat.for="file of selectedFiles | fileListToArray">
      <div class="col-6">
        <img src.bind="file | blobToUrl" class="card-img-top">
      </div>
      <div class="col-6">
        <h3>${file.name}</h3>
        <h3>${file.type}</h3>
        <h3>${(file.size / 1024 / 1024).toFixed(2)} mb</h3>
        <p>Last Modified: ${file.lastModifiedDate}</p>
        <div class="progress" if.bind="loading">
          <div class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar" aria-valuenow.bind="progress" aria-valuemin="0" aria-valuemax.bind="uploadSize" css="width: ${progressPercentage}%"></div>
        </div>
        <button class.bind="loading ? 'btn btn-lg btn-outline-success' : 'btn btn-lg btn-success'" type="submit" click.trigger="upload()" disabled.bind="loading || success">
          <span if.bind="loading"><span class="spinner-grow spinner-grow-sm" role="status" aria-hidden="true"></span>Subiendo...</span>
          <span if.bind="!loading && !success && uploadedFiles != selectedFiles">Subir</span>
          <span if.bind="success">Listo! <i class="fas fa-check"></i></span>
        </button>
      </div>
    </div>
  </div>
</template>